<div class="component">
  <h2 class="stat-title">{{ isAddingExpense ? 'add an expense' : 'daily expenses' }}</h2>
  <div class="date-display">{{ selectedDate | date:'fullDate' }}</div>
  
  <!-- Normal expenses view -->
  <div *ngIf="!isAddingExpense" class="expenses-container scrollable">
    <div *ngIf="expenses.length === 0" class="no-expenses">
      no expenses for this day
    </div>
    <div *ngFor="let expense of expenses" class="expense-item" 
         (mouseenter)="onExpenseHover(expense, true)"
         (mouseleave)="onExpenseHover(expense, false)"
         (mousedown)="startDeleteTimer(expense)"
         (mouseup)="cancelDeleteTimer()"
         (mouseleave)="cancelDeleteTimer()">
      <div class="expense-info">
        <div class="expense-category" [style.color]="getCategoryColor(expense.categoryName)">
          {{ expense.categoryName }}
        </div>
        <div class="expense-description">{{ expense.description }}</div>
      </div>
      <div class="expense-amount">{{ expense.amount | number:'1.2-2' }} pln</div>
      
      <!-- Delete overlay -->
      <div class="delete-overlay" 
           [class.visible]="expense.id === hoveredExpenseId"
           [class.deleting]="expense.id === deletingExpenseId">
        <div class="delete-text">delete</div>
        <div class="delete-progress" 
             [style.width.%]="expense.id === deletingExpenseId ? deleteProgress : 0"></div>
      </div>
    </div>
  </div>
  
  <!-- Add expense form -->
  <div *ngIf="isAddingExpense" class="add-form-container">
    <div class="form-field">
      <label class="form-label">description</label>
      <input 
        type="text" 
        class="form-input" 
        [(ngModel)]="newExpense.description"
        placeholder="enter expense description"
      >
    </div>
    
    <div class="form-field">
      <label class="form-label">category</label>
      <select class="form-select" [(ngModel)]="newExpense.categoryId">
        <option *ngFor="let category of allCategories" [value]="category.id">
          {{ category.name }}
        </option>
      </select>
    </div>
    
    <div class="form-field">
      <label class="form-label">amount (pln)</label>
      <input 
        type="number" 
        class="form-input" 
        [(ngModel)]="newExpense.amount"
        placeholder="0.00"
        step="0.01"
        min="0"
      >
    </div>
  </div>
  
  <div *ngIf="!isAddingExpense && expenses.length > 0" class="daily-total">
    <div class="total-label">total for day:</div>
    <div class="total-amount">{{ getDailyTotal() | number:'1.2-2' }} pln</div>
  </div>
  
  <!-- Buttons -->
  <div class="button-section">
    <button *ngIf="!isAddingExpense" class="add-expense-btn" (click)="addExpense()">
      + add expense
    </button>
    
    <div *ngIf="isAddingExpense" class="button-row">
      <button class="back-btn" (click)="cancelAddExpense()">
        ‚Üê back
      </button>
      <button class="save-btn" (click)="saveExpense()">
        add
      </button>
    </div>
  </div>
</div>
